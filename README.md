# 📋 任务管理板 - Trello风格

一个完全离线的任务管理应用，模仿Trello的看板风格，使用纯HTML、CSS和JavaScript开发，无需联网即可在浏览器中使用。

## ✨ 功能特性

### 核心功能
- **📝 任务管理**：创建、编辑、删除任务
- **📊 多列表看板**：支持创建多个列表（如：待办、进行中、已完成）
- **🎯 任务拖拽**：通过拖拽在不同列表间移动任务，或同优先级任务间重新排序
- **📋 列表拖拽**：支持通过拖拽改变列表的相对位置
- **🔢 智能排序**：任务按优先级自动排序（高→中→低），同优先级可拖拽调整位置
- **💾 本地存储**：所有数据保存在浏览器本地，无需服务器
- **⏰ 截止日期**：为任务设置截止时间
- **🔔 智能提醒**：任务即将到期或已逾期时自动提醒（每天最多一次）
- **📈 进度跟踪**：为每个任务设置完成进度（0-100%）
- **🎨 优先级标识**：高、中、低三种优先级，用不同颜色标识
- **🛡️ 列表保护**："已完成"列表不可删除，确保任务状态和提醒功能正常
- **📥📤 数据导入导出**：支持将数据导出为JSON文件或从文件恢复

### 任务详情
- 任务标题
- 任务描述
- 截止日期和时间
- 优先级（高/中/低）
- 完成进度百分比
- 创建时间
- 完成时间（已完成任务）
- 上次提醒日期

### 排序规则
- **优先级排序**：高优先级（红色）→ 中优先级（黄色）→ 低优先级（绿色）
- **同优先级排序**：保持拖拽后的顺序，新任务自动插入到同优先级组最后
- **拖拽排序**：支持同优先级任务之间的拖拽排序，跨优先级拖拽会提示错误
- **列表排序**：支持通过拖拽改变列表的相对位置

## 🚀 使用方法

### 快速开始 (桌面应用版)

#### 📦 免安装版 (推荐)
**适合没有 Apple 开发者签名的 Mac 设备**

1. 下载 `Doit-x.x.x-portable-mac.zip` 文件
2. 双击解压到任意位置
3. 双击 `launch-mac.sh` 启动应用
4. ✅ 无需安装，无需命令行操作

详细说明请查看 [docs/PORTABLE_GUIDE.md](docs/PORTABLE_GUIDE.md)

#### 🖥️ 正常安装版
1. 下载对应的安装包（.dmg 或 .zip）
2. 按照安装向导完成安装
3. 从"应用程序"文件夹启动

### 浏览器版
1. 下载所有文件（`index.html`、`styles.css`、`app.js`）到同一文件夹
2. 双击打开 `index.html` 文件
3. 开始使用！

### 基本操作

#### 1. 创建列表
- 点击顶部的 **"+ 添加列表"** 按钮
- 输入列表名称（如：待办、进行中、已完成）
- 点击 **"创建"** 按钮

#### 2. 添加任务
- 在任意列表底部点击 **"+ 添加任务"** 按钮
- 填写任务信息：
  - **任务标题**（必填）
  - **任务描述**（可选）
  - **截止日期**（可选）
  - **优先级**（低/中/高）
  - **进度**（0-100%）
- 点击 **"保存"** 按钮

#### 3. 编辑任务
- 点击任务卡片右上角的 ✏️ 图标
- 修改任务信息
- 点击 **"保存"** 按钮

#### 4. 删除任务
- 点击任务卡片右上角的 🗑️ 图标
- 确认删除

#### 5. 移动任务
- 按住任务卡片并拖拽到目标列表
- 松开鼠标完成移动
- 拖拽到"已完成"列表时，任务会自动标记为已完成状态
- 从"已完成"列表拖出时，任务会恢复为未完成状态

#### 6. 同优先级任务排序
- 在同一列表内，按住任务卡片拖拽到同优先级的其他任务上
- 松开鼠标完成排序
- **注意**：只能在相同优先级的任务之间进行拖拽排序
- 跨优先级拖拽会提示错误

#### 7. 删除列表
- 点击列表标题右侧的 🗑️ 图标
- 确认删除（注意：列表中的所有任务也会被删除）
- **重要**："已完成"列表不能删除，因为涉及任务状态和提醒弹窗功能
- 如果需要清理已完成任务，可以删除该列表中的具体任务
- **注意**："已完成"列表右上角不显示删除按钮

#### 8. 列表拖拽排序
- 按住列表标题或列表区域进行拖拽
- 拖拽到其他列表附近，会显示蓝色指示线
- 松开鼠标完成位置交换
- 所有列表都可以拖拽（包括"已完成"列表）

#### 9. 导出数据到文件
- 点击顶部的 **"📥 导出数据"** 按钮
- 系统会自动下载一个JSON文件（文件名格式：`任务管理板_日期时间.json`）
- 该文件包含所有列表和任务数据

#### 10. 从文件导入数据
- 点击顶部的 **"📤 导入数据"** 按钮
- 选择之前导出的JSON文件
- 确认导入（注意：会覆盖当前所有数据）
- 数据导入成功

#### 11. 清空所有数据
- 点击顶部的 **"清空所有数据"** 按钮
- 确认操作
- 此操作会清空所有任务，但会保留"已完成"列表
- 其他所有列表及其任务都会被删除
- **注意**：清空后的数据无法恢复，请谨慎使用

## 🎨 优先级说明

任务卡片左侧有颜色条标识优先级：
- 🔴 **红色**：高优先级
- 🟡 **黄色**：中优先级
- 🟢 **绿色**：低优先级

## ⏰ 截止日期提醒

系统会自动检查任务的截止日期（每分钟检查一次）：
- **即将到期**（1小时内）：任务显示黄色警告，并弹出提醒
- **已逾期**：任务显示红色警告，并弹出提醒
- **已完成任务**：不会触发任何提醒，即使已逾期

提醒频率限制：
- 每个任务每天最多提醒一次
- 首次使用时，浏览器会请求通知权限，建议允许以接收桌面通知
- 提醒后会自动记录当天的提醒时间，避免重复打扰

任务状态标识：
- ⏰ 正常时间：显示截止日期时间
- 🟡 即将到期：显示"即将到期" + 截止日期时间
- 🔴 已逾期：显示"已逾期" + 截止日期时间
- ✅ 已完成：显示截止日期时间 + "(已完成)"

## 💾 数据存储

应用支持两种数据存储方式：

### 1. 浏览器本地存储（默认）
- ✅ 自动保存，刷新页面数据不丢失
- ✅ 完全离线工作
- ⚠️ 清除浏览器数据会导致任务丢失
- ⚠️ 不同浏览器的数据不共享

### 2. 文件存储（推荐）
- ✅ **导出数据**：点击"📥 导出数据"按钮，将所有数据保存为JSON文件
- ✅ **导入数据**：点击"📤 导入数据"按钮，从JSON文件恢复数据
- ✅ **数据备份**：可以保存多个备份文件，防止数据丢失
- ✅ **跨设备使用**：通过文件在不同设备间同步数据
- ✅ **版本管理**：可以保留不同时间点的数据快照

**建议**：定期使用"导出数据"功能备份数据到本地文件，确保数据安全！

## 📱 响应式设计

应用支持不同屏幕尺寸：
- 💻 桌面端：横向排列多个列表
- 📱 移动端：纵向排列列表，适配小屏幕

## 🛠️ 技术栈

- **HTML5**：页面结构
- **CSS3**：样式和动画
- **JavaScript (ES6+)**：交互逻辑
- **LocalStorage API**：数据持久化
- **Drag and Drop API**：拖拽功能
- **Notification API**：桌面通知

## 📋 文件说明

```
Doit/
├── index.html                  # 主HTML文件
├── styles.css                  # 样式文件
├── app.js                      # JavaScript逻辑
├── main.js                     # Electron主进程
├── preload.js                  # 预加载脚本
├── package.json                # 项目配置
├── README.md                   # 项目主文档
├── build.sh                    # 构建脚本
├── create-icons.sh             # 图标生成脚本
├── launch-mac.sh               # macOS启动脚本
├── fix-quarantine.sh           # Gatekeeper修复脚本
├── entitlements.mac.plist     # macOS权限配置
├── assets/                     # 资源目录
│   └── icon.*                  # 应用图标
├── docs/                       # 文档目录
│   ├── INDEX.md               # 文档索引
│   ├── INSTALLATION.md        # 安装指南
│   ├── PORTABLE_GUIDE.md      # 便携版指南
│   ├── QUICK_REFERENCE.md     # 快速参考
│   └── ...                    # 更多文档
├── scripts/                    # 构建脚本
│   ├── create-portable.js     # 便携版打包脚本
│   └── generate-icons.sh      # 图标生成脚本
└── dist/                       # 构建输出目录
```

## 🔧 浏览器兼容性

推荐使用现代浏览器：
- ✅ Chrome 60+
- ✅ Firefox 55+
- ✅ Safari 11+
- ✅ Edge 79+

## 💡 使用技巧

1. **合理规划列表**：建议创建"待办"、"进行中"、"已完成"等状态列表
2. **设置优先级**：为重要任务设置高优先级，便于识别和排序
3. **添加截止日期**：为有时间要求的任务设置截止时间
4. **更新进度**：及时更新任务进度，掌握工作进展
5. **利用任务拖拽排序**：在同优先级任务中拖拽调整顺序，优化任务执行流程
6. **利用列表拖拽排序**：调整列表的相对位置，优化看板布局
7. **定期清理**：删除已完成的旧任务，保持看板整洁
8. **定期备份**：使用"导出数据"功能定期备份数据到文件
9. **跨设备同步**：通过导出/导入功能在不同设备间同步数据
10. **注意"已完成"列表**：该列表不可删除，但可以删除其中的具体任务
11. **任务完成流程**：将任务拖拽到"已完成"列表或完成任务后，会自动记录完成时间
7. **定期清理**：删除已完成的旧任务，保持看板整洁
8. **定期备份**：使用"导出数据"功能定期备份数据到文件
9. **跨设备同步**：通过导出/导入功能在不同设备间同步数据
10. **注意"已完成"列表**：该列表不可删除，但可以删除其中的具体任务
11. **任务完成流程**：将任务拖拽到"已完成"列表或完成任务后，会自动记录完成时间
12. **清空数据**：清空所有数据时会保留"已完成"列表，其他列表会被删除

## ⚠️ 注意事项

1. **数据安全**：
   - 浏览器本地存储可能因清除缓存而丢失
   - **强烈建议定期使用"导出数据"功能备份到文件**
   - 导出的JSON文件可以妥善保管，防止数据丢失

2. **跨设备使用**：
   - 浏览器localStorage数据不同步
   - 使用"导出/导入"功能在不同设备间传输数据

3. **通知权限**：
   - 允许浏览器通知权限以接收截止日期提醒
   - 每个任务每天最多提醒一次，避免重复打扰
   - 已完成任务不会触发任何提醒

4. **文件格式**：
   - 导入时只接受JSON格式文件
   - 请勿手动修改导出的JSON文件，可能导致数据损坏

5. **列表保护**：
   - "已完成"列表不能删除，因为涉及任务状态和提醒弹窗功能
   - "已完成"列表右上角不显示删除按钮
   - 如需清理，可以删除该列表中的具体任务
   - 拖拽任务到"已完成"列表会自动标记为完成状态
   - 清空所有数据时会保留"已完成"列表

6. **任务排序**：
   - 任务按优先级自动排序：高→中→低
   - 只能在相同优先级的任务之间进行拖拽排序
   - 跨优先级拖拽会提示错误
   - 新任务自动添加到同优先级组的最后位置

7. **列表拖拽**：
   - 可以通过拖拽改变列表的相对位置
   - 所有列表都可以拖拽（包括"已完成"列表）
   - 拖拽时会显示蓝色指示线提示插入位置

## 📝 更新日志

### v2.0.0 (2025-01-13) - 重大更新
- 🎉 **全新智能排序系统**：任务按优先级分组排序，同优先级任务保持拖拽顺序
- 🎯 **列表拖拽排序**：支持通过拖拽改变列表的相对位置
- 🔒 **"已完成"列表完全保护**：
  - 列表右上角不显示删除按钮
  - 清空所有数据时保留"已完成"列表（清空任务但保留列表）
  - 禁止删除"已完成"列表，确保任务状态和提醒功能正常
- 🎨 **增强的视觉反馈**：
  - 拖拽时显示蓝色指示线，更容易触发
  - 列表拖拽时的半透明和缩放效果
  - 平滑的过渡动画
- 📊 **智能排序逻辑**：
  - 高优先级任务 → 中优先级任务 → 低优先级任务
  - 同优先级任务之间可自由拖拽排序
  - 新增任务自动插入到同优先级组的最后位置
- ✅ **优化清空数据功能**：清空所有任务，但保留"已完成"列表本身
- ✅ **完善任务状态管理**：任务移动到"已完成"列表时自动记录完成时间
- ✅ **优化提醒功能**：已完成任务不再触发逾期提醒，每天最多提醒一次

### v1.5.0 (2025-01-13)
- ✨ 新增智能排序功能：任务按优先级自动排序（高→中→低）
- ✨ 新增同优先级拖拽排序：支持在同优先级任务之间拖拽调整顺序
- ✨ 新增新任务位置优化：新任务自动添加到同优先级组的最后位置
- ✅ 完善任务状态管理：任务移动到"已完成"列表时自动记录完成时间
- ✅ 优化提醒功能：已完成任务不再触发逾期提醒，每天最多提醒一次
- ✅ 保护"已完成"列表：禁止删除"已完成"列表，确保任务状态和提醒功能正常
- ✅ 修复任务完成状态bug：已完成任务不会再次触发逾期提醒

### v1.2.0 (2024)
- ✨ 新增数据导出功能（保存为JSON文件）
- ✨ 新增数据导入功能（从JSON文件恢复）
- ✅ 支持文件形式的数据备份和恢复
- ✅ 支持跨设备数据同步
- ✨ 新增 Electron 桌面应用支持
- ✨ 新增 macOS 免安装版（便携版）
- ✨ 新增自动构建脚本

### v1.0.0 (2024)
- ✨ 初始版本发布
- ✅ 支持多列表管理
- ✅ 任务拖拽功能
- ✅ 截止日期提醒
- ✅ 进度跟踪
- ✅ 优先级管理
- ✅ 本地数据存储

## 🛠️ 开发说明

### 环境要求
- Node.js 16+
- npm 或 yarn

### 安装依赖
```bash
npm install
```

### 开发模式
```bash
npm start
```

### 构建应用

#### 构建 macOS 正式版
```bash
npm run build:mac
```
输出: `dist/Doit-2.0.0-arm64.dmg`

#### 构建 macOS 免安装版 (推荐)
```bash
npm run build:mac-portable
```
输出: `dist/Doit-2.0.0-portable-mac.zip`
- 无需安装，解压即用
- 包含自动启动脚本
- 自动处理 macOS Gatekeeper 限制

#### 构建 Windows 版本
```bash
npm run build:win
```
输出: 
- `dist/Doit Setup 2.0.0.exe` (安装版)
- `dist/Doit 2.0.0.exe` (免安装版)

#### 构建所有平台
```bash
npm run build
```

### 生成图标
```bash
npm run icons
```

## 📄 许可证

MIT License - 可自由使用和修改

---

**享受高效的任务管理体验！** 🎉
